---
title: "Kickstarter Analysis Proposal"
subtitle: "10/9/2020"
author: "The Laureates: Farzeen Najam, Olivia Olsher, Vincent Liu, Emile Therrien"
output: pdf_document
---

### Notes for our group moving forward: to be included along with rough draft comments

Need to change the first data analysis to pledged over real because the "state"
variable has too many qualifiers that might neglect certain succesful obs
even though they weren't listed as "successful"

In Emile and Olivia's part, exclude the live data

For Farzeen: need to explain why you chose certain variables and how you then
incorporated those into your hypo test
-why omit tier 7?

Emile and olivia: need to see what category is most likely to be funded
  what should the size of sample for the bootstraps be?
  use regression to model this? what sort of regression?

# Introduction
Have you ever had an ambitious idea but did not have resources to pursue it? Kickstarter is a crowdfunding platform for creators who need support for their projects. Since launching in 2009, 19 million people have pledged to back up projects, and nearly 190,000 projects have been successfully funded.
 
However, many more projects failed to reach their goals, and our group is interested in analyzing what made projects succeed and fail. The dataset that we use comes from Kaggle, which contains Kickstarter projects up until January 2018.
 
We will be exploring which variables influence the success of a Kickstarter project by observing which types of projects are more likely to be funded. Our questions include:

* Does the amount of money a project asks for influence it’s chance of success?
* Does the category of project influence it’s chance of success?

Our hypotheses include:

* The more money the project asks for, the less successful it will be in terms of getting funding.
* The category “Technology” will be the most likely funded type of projects.



# Data description
This data set contains 15 variables and 378,661 observations, where each observation is one kickstarter project.

The categorical variables include the name of each project, the category of each project (music, narrative film, restaurant, etc.), a broader category of each (food, film, publishing, etc.), the crowdsourcing currency, the state of each project (failed, successful, or cancelled), and the country of origin for each project.

The numerical data are the project’s ID number, the monetary goal for each, the money pledged to each project, how many backers of each project; there are three numerical variables that are not self-explanatory, usd_pledged: conversion in US dollars of the pledged column (conversion done by kickstarter), usd_pledge_real: conversion in US dollars of the pledged column (conversion from Fixer.io API), and usd_goal_real: conversion in US dollars of the goal column (conversion from Fixer.io API).

There are also two date columns, one for the project launch and the other for the crowdsourcing deadline.

The data were collected from Kickstarter Platform likely using web scraping methods on their own site, to be used by data scientists to model whether or not a project will be successful or not when it is launched.


# Glimpse of data

```{r file-glimpse, eval=TRUE, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)

kickstarter <- read_csv("data/ks-projects-201801.csv")
glimpse(kickstarter)

```

# Explorative Data Analysis

### Overview of project state:

```{r state-analysis}
kickstarter_intro = kickstarter %>%
  group_by(state) %>%
  count()

kickstarter_intro2 = kickstarter %>%
  filter(state == "successful") %>%
  summarize("project success rate" = n()/nrow(kickstarter))


kickstarter_intro
kickstarter_intro2
```

### Overview of pledged and goal money in USD:

```{r pledged-and-goal-overview, echo=FALSE}
overview_usd_pledged_real <- kickstarter %>%
  summarize(mean = mean(usd_pledged_real),
            median = median(usd_pledged_real),
            sd = sd(usd_pledged_real)) %>% 
  mutate(type = "pledged")

overview_usd_goal_real <- kickstarter %>%
  summarize(
    mean = mean(usd_goal_real),
    median = median(usd_goal_real),
    sd = sd(usd_goal_real)
    )%>% 
  mutate(type = "goal")

overview_usd_pledged_real
overview_usd_goal_real

pledged_goals = full_join(overview_usd_pledged_real, overview_usd_goal_real,
                          by = NULL)

ggplot(data = pledged_goals, aes(x = type, y = mean,
                                 fill = type)) +
  scale_fill_viridis_d()+
  geom_col()
```

### Project Goal & Success

*Question*: Is the project goal (amount of money a project asks for) associated with whether it is successful?

*Hypotheses*:

* $H_0$: There is no relationship between a project's goal and whether a project is successful or not.
* $H_1$: There is a relationship between a project's goal and whether a project is successful or not.

Create a new data frame with projects that are no longer live:

```{r exclude-ongoing-projects}
# Exclude ongoing projects
kickstarter_not_live <- kickstarter %>%
  filter(state != "live")
```

Create a new variable named usd_goal_real_tier to classify usd_goal_real into tiers:

```{r mutate-goal-tiers, warning=FALSE}
# perhaps need a better way to categorize values in this column
kickstarter_not_live <- kickstarter_not_live %>%
  mutate(usd_goal_real_tier = case_when(
    usd_goal_real < 1000 ~ 1,
    usd_goal_real >= 1000 & usd_goal_real < 5000 ~ 2,
    usd_goal_real >= 5000 & usd_goal_real < 10000 ~ 3,
    usd_goal_real >= 10000 & usd_goal_real < 20000 ~ 4,
    usd_goal_real >= 20000 & usd_goal_real < 100000 ~ 5,
    usd_goal_real >= 100000 & usd_goal_real < 500000 ~ 6,
    usd_goal_real >= 500000 ~ 7,
  ))

chart<- kickstarter_not_live %>%
  group_by(usd_goal_real_tier) %>%
  summarize(numbers = n())

chart
 
ggplot(data = chart, mapping = aes(x = usd_goal_real_tier, y = numbers, 
                                  fill = as.factor(usd_goal_real_tier))) +
  geom_col() +
  scale_fill_viridis_d()+
  labs(title = "Tier 2 has the most amount of projects",
       x = "Tier number", y = "Count of projects") +
  theme_minimal() + 
  theme(legend.position = "none")
 

```

Create a new variable for success state

```{r mutate-success-state}
kickstarter_not_live <- kickstarter_not_live %>%
  mutate(success_state = if_else(state == "successful", 1, 0))
```

We'll run a chi-square test at alpha = 0.05.

```{r goal-state-association}
chisq.test(table(kickstarter_not_live$success_state, 
                 kickstarter_not_live$usd_goal_real_tier))
```

Our test statistic was 19624, which has a chi-square distribution with 6 degree of freedom under $H_0$. This corresponds to a p-value less than 2.2e-16. So our decision is to reject $H_0$, and there is sufficient evidence that there is a relationship between a project's monetary goal and a project's state of success.

### Project Goal Amount & Success

*Claim*: The more money the project asks for, the less successful it will be in terms of getting funding.

$H_0$: $S_{less-money}$ $\le$ $S_{more-money}$
$H_1$: $S_{less-money}$ > $S_{more-money}$

$H_0$:proportion of people who successful with low money goal - proportion of people who successful with high money <= 0
$H_1$: proportion of people who successful with low money goal - proportion of people who successful with high money > 0 

$\alpha$ = 0.05


```{r}
set.seed(2)
     kick1 <- kickstarter_not_live %>% 
       filter(usd_goal_real_tier == 6 | usd_goal_real_tier == 5 | 
                usd_goal_real_tier ==4)
     
     kick2 <- kickstarter_not_live %>%
        filter(usd_goal_real_tier == 1 | usd_goal_real_tier == 2 | 
                 usd_goal_real_tier ==3)
       
n_sims <- 500
boot_dist <- numeric(n_sims)
for(i in 1:n_sims){
  
  # create indices
  indices_m <- sample(1:nrow(kick1), replace = T)
  indices_l <- sample(1:nrow(kick2), replace = T)
  
  
  # bootstrap est. group means
  temp_m <- kick1 %>% 
    slice(indices_m) %>% 
    filter(success_state == 1) %>%
    summarize(prop_m = n()/ 141243) %>% 
    select(prop_m) %>% 
    pull()
  

  temp_l <-kick2  %>% 
    slice(indices_l) %>% 
    filter(success_state == 1) %>%
    summarize(prop_s= n()/231825) %>% 
    select(prop_s) %>% 
    pull()

  boot_dist[i] <-   temp_l - temp_m   #diff btw low goal success high goal success
}
boot_diffs <- tibble(diffs = boot_dist)


obs_diff <- boot_diffs %>% 
  summarize(obs_diff = mean(diffs)) %>% 
  pull()

offset <- boot_diffs %>% 
  summarize(offset = 0 - mean(diffs)) %>% 
  pull()
null_dist <- boot_diffs %>% 
  mutate(centered_diffs = diffs + offset) %>% 
  select(centered_diffs)

null_dist %>% 
  mutate(extreme = ifelse(centered_diffs > abs(obs_diff), 1, 0)) %>% 
  summarize(p_val = mean(extreme))


boot_diffs %>% 
  summarize(lower = quantile(diffs, 0.025),
            upper = quantile(diffs, 0.975))
 

```
Since our p-value is less than our alpha value, we reject our null hypothesis that
the difference in the proportion of projects with less money as goal and proportion
of projects with more money as goal is less than or equal to 0.This means we reject
the null hypothesis that success rate for projects with bigger money is equal or
higher than projects with lower money.



### Project Category and Success

* Is the category associated with the chance of success a project has?
* The category “Technology” will be the most likely funded type of project.

limitations: possible crossover in the main_categories that we cannot screen
for

```{r category-success}
kickstart_success = kickstarter %>% 
  mutate(
    project_funding_ratio = pledged/goal,
    success = case_when(
      project_funding_ratio >= 1 ~ "Achieved",
      project_funding_ratio < 1 ~ "Not achieved"
    )
  )

kickstater_success_ratios = kickstart_success %>% 
  group_by(main_category, success) %>% 
  count(success) %>% 
  group_by(main_category) %>% 
  mutate(
    prop = n/sum(n)
  ) 

kickstater_success_ratios
  
ggplot(data = kickstater_success_ratios, aes(x = success, 
                                             y = prop,
                                             fill = main_category)) +
  ylim(0, 1)+
  facet_wrap(. ~ main_category) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Success",
       y = "Proportion of successful projects",
       title = "All project categories had a greater unsuccessful proportion",
       subtitle = "Except for Comics, Dance, and Theater")+
  scale_fill_viridis_d()

```

main_category vs. success

$H_0$: There is no relationship between main_category and success.

$H_1$: There is a relationship between main_category and success. 

Where the $alpha/$ = 0.05

```{r CLT-main_category}
chisq.test(table(kickstart_success$main_category, kickstart_success$success))
```

Given that the p-value is less than $alpha/$ = 0.05, we can reject the null hypothesis. Thus, there is sufficient evidence to suggest that there is a relationship between main category and success.

#### Simulation, tech is the most likely to be funded

$H_0$: $p_{s-tech}$ $\le$ $p_{s-other}$
$H_1$: $p_{s-tech}$ > $p_{s-other}$

```{r simulation - technology}
set.seed(1)

kickstart_boot = kickstart_success %>% 
  mutate(
    TECH = case_when(
      main_category == "Technology" ~ "TECH",
      main_category != "Technology" ~ "other"
    )
  )
kickstart_boot
         
obs_diff = kickstart_boot %>% 
  group_by(TECH) %>% 
  count(success) %>% 
  mutate(prop = n/sum(n)) %>% 
  filter(success == "achieved") %>% 
  select(TECH, prop)
obs_diff

diff = obs_diff[2,2] - obs_diff[1,2] #take second row and second column - ...
diff

tech = kickstart_boot %>% 
  filter(TECH == "TECH")
other = kickstart_boot %>% 
  filter(TECH != "TECH")

boot_samp <- numeric(500)

for(i in 1:500){
  boot_tech <- tech %>% 
    slice(sample(1:nrow(tech), replace = T)) %>% 
    count(success) %>% 
    mutate(prop = n/sum(n)) %>% 
    select(prop) %>% 
    slice(1) %>%
    pull()
  boot_other<- other %>% 
    slice(sample(1:nrow(other), replace = T)) %>% 
    count(success) %>% 
    mutate(prop = n/sum(n)) %>% 
    select(prop) %>% 
    slice(1) %>%
    pull()
  
  boot_samp[i] <- boot_tech - boot_other
}

#mean of bootstrap samples:
mean_boot = mean(boot_samp)
boot_samp = tibble(boot_samp)


boot_samp <- boot_samp %>% 
  mutate(centered = boot_samp + abs(mean_boot))
       
boot_samp %>% 
  mutate(extreme = if_else(centered > abs(diff), 0, 1)
  ) %>% 
  summarize(p_val = mean(extreme))

ggplot(data = boot_samp, aes(x = centered)) + 
  geom_histogram(color = "darkblue", fill = "skyblue") +
  labs(x = "centered means", y = "count") +
  geom_vline(xintercept = diff$prop, color = "red")

```

We have a p-value of 1, which means there is not sufficient evidence at the $\alpha$ = 0.05 level to reject the null hypothesis that the proportion of success for main categories other than Technology is the same or greater than the proportion of sucess for Technology. 


